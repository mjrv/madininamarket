<!DOCTYPE html>
<html lang="en">
<head>
    <title>{% block title %}Welcome!{% endblock %}</title>
    {% block stylesheets %}{% endblock %}
    <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />  <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
      <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
      <link rel="stylesheet" href="{{asset("asset/css/variables.css")}}">
      <link rel="stylesheet" href="{{asset("asset/css/front.css")}}">
      <style>
    /* Remove the navbar's default margin-bottom and rounded borders */ 
    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }
    
    /* Set height of the grid so .sidenav can be 100% (adjust as needed) */
    .row.content {height: 450px}
    
    /* Set gray background color and 100% height */
    .sidenav {
      padding-top: 20px;
      background-color: #f1f1f1;
      height: 100%;
    }
    
    /* Set black background color, white text and some padding */
    footer {
      background-color: #555;
      color: white;
      padding: 15px;
    }
    
    /* On small screens, set height to 'auto' for sidenav and grid */
    @media screen and (max-width: 767px) {
      .sidenav {
        height: auto;
        padding: 15px;
      }
      .row.content {height:auto;} 
    }
  </style>
</head>
<body>

<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="{{ path('homepage')}}"><img src="{{asset('asset/img/logo1.png')}}" alt="logo Madininamarket"></a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li><a href="{{path('homepage')}}"><i class="fa fa-home" aria-hidden="true"></i> MadininaMarket</a></li>
        <li class="dropdown">
          <a href="#">Liste des boutiques</a>
          {{render(controller("MarketplaceBundle:Nav:shopNav"))}}
        </li>
        <li>{{render(controller('MarketplaceBundle:Nav:categories'))}} </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
          <li><a href="{{ path('fos_user_security_logout')}}"><span class="glyphicon glyphicon-log-out"></span> Logout</a></li>
        {% else %}
            <li><a href="{{path('fos_user_security_login')}}"><i class="fa fa-handshake-o" aria-hidden="true"></i> Login</a>
            </li>
        {% endif %}
        {% if is_granted('ROLE_EDITOR') %}
          <li><a href="{{path('seller')}}">seller</a>
          </li>
        {% endif %}
        {% if is_granted('ROLE_ADMIN') %}
          <li><a href="{{path('admin')}}">admin</a>
          </li>
        {% endif %}

       <li><a href="{{path('cart')}} "><i class="fa fa-shopping-cart" aria-hidden="true"></i> panier</a></li>

      </ul>
    </div>
  </div>
</nav>
<div class="container col-md-12">
  {% block banderole %}{% endblock %}
</div>
<div class="container-fluid text-center">    
  <div class="row content">

    <div class="col-sm-2 sidenav">
      {% block seller %}
        {{render(controller('MarketplaceBundle:Nav:shop'))}}
      {% endblock %}
    </div>

    <div class="col-sm-10 text-left"> 
      <div class="container">
         {% block body %}{% endblock %}
      </div>
    </div>

    
  </div>
</div>

<footer class="container-fluid text-center">
  <div class="col-md-12">
    <a href="#">CGV</a>    
    <a href="#">Mentions legales</a>    
    <a href="#">Nous contacter</a>    
    <a href="#">Faq</a>    
  </div>
  <div class="col-md-12">
    <p>{{shop_name}} &copy 2017 {% if "now"|date('Y') > 2017  %} - {{ "now"|date('Y') }}{% endif %}</p>
  </div>
</footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="{{ asset('asset/js/functions.js') }}"></script>
<script>
$(function()
{
  //Permet de derouler le menu au hover
  dropdownMenu();

  // On envoi le formulaire a la sélection de la catégorie
  $("#category").on("change", function()
  {
    $("#recherche").submit();
  });

  // On met les valeurs de la recherche dans les champs du form de recherche (s'ils existent)
  var category = $.urlParam('category');
  var search = $.urlParam('search');

  if( category != 0)
  {
    $("#category optgroup option[value="+category+"]").attr("selected", "selected");
  }

  if(search != 0)
  {
    $("#search").val(search);
  }
  
  var items = []; 
  $.get("{{path('listItems')}}", function(data)
  {
    // console.log(data);
    $.each(data, function(index, val)
    {
      // console.log(index);
      // console.log(val);
      items.push(val.name);
    });
  });

  // console.log(items);
  // https://jqueryui.com/autocomplete/
  $( "#search" ).autocomplete({
    source: items
  });


})

// source : https://www.sitepoint.com/url-parameters-jquery/
$.urlParam = function(name){
  var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
  return results[1] || 0;
}

</script>

{% block javascripts %}
{% endblock %}
</body>
</html>